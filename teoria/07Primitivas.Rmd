---
title: "Tema 7 - Cálculo de Primitivas"
author: "Juan Gabriel Gomila, Arnau Mir y Llorenç Valverde"
date: ''
output: 
  ioslides_presentation:
    widescreen: true
    css: Mery_style.css
    logo: Images/calculus.gif
    fig_caption: yes
---
<script src="https://kit.fontawesome.com/a0edb659c7.js" crossorigin="anonymous"></script>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
reticulate::use_python("/Users/juangabriel/anaconda3/bin/python")
#reticulate::py_install("sympy")
```


# Introducción

## Introducción al cálculo de primitivas
En el tema anterior, vimos que para calcular la **integral definida** de una función $f$ integrable en un cierto intervalo $[a,b]$, es fundamental saber calcular una **primitiva** $F$ de dicha función ya que dicha integral, usando la **regla de Barrow**, se puede escribir de la siguiente forma:
$$
\int_a^b f(x)\, dx = F(b)-F(a).
$$

En este tema, vamos a dar las técnicas para calcular **primitivas** de las funciones más usuales como pueden ser funciones **polinómicas**, **racionales**, **trigonométricas**, funciones definidas como la raíz cuadrada de un polinomio hasta de grado 2, etc.

## Introducción al cálculo de primitivas
Recordad que dada una función $f:[a,b]\longrightarrow\mathbb{R}$ definida en un intervalo $[a,b]$, una **primitiva** es una función $F:[a,b]\longrightarrow\mathbb{R}$ definida en el mismo intervalo tal que $F'(x)=f(x)$. 

Ésta es la razón que la **primitiva** de una función también se llame **antiderivada** ya que hallar **primitivas** es la operación **inversa** respecto a la operación de **derivar**. Si **derivar** es equivalente a dar un paso hacia delante, hallar una **primitiva** es dar un paso hacia atrás.

Recordemos que, dada una función $f$, existen una multitud de **primitivas** de la misma: dada una **primitiva** $F(x)$ de la misma, la función $F(x)+C$ donde $C$ es una constante cualquiera es también otra primitiva ya que si $F'(x)=f(x)$, también se cumple que $(F(x)+C)'=f(x)$.

## Introducción al cálculo de primitivas
A hallar una **primitiva** de una función $f$ también se conoce como hallar una **integral indefinida** de dicha función y lo denotaremos por:
$$
\int f(x)\, dx = F(x)+C,
$$
sin escribir los extremos de integración y añadiendo una constante cualquiera $C$ para poder de manifiesto que, como hemos indicado antes, existen una multitud de primitivas.

## Introducción al cálculo de primitivas
Supongamos que para una función $f$ particular, nos dan una **primitiva** $F$. Es decir $F'(x)=f(x)$ o $\displaystyle\int f(x)\, dx=F(x)+C$. 

Entonces, si en lugar de considerar la función $f$ consideramos la función siguiente $f(g(x))\cdot g'(x)$, donde $g(x)$ es una función cualquiera, tenemos que una **primitiva** de dicha función es $(F\circ g)(x)=F(g(x))$ ya que usando la regla de la cadena 
$$
(F\circ g)'(x)=F'(g(x))\cdot g'(x)=f(g(x))\cdot g'(x),
$$
como queríamos ver.

## Introducción al cálculo de primitivas
Es decir, si $\displaystyle\int f(x)\,dx =F(x)+C$, entonces $\displaystyle\int f(g(x))\cdot g'(x)\,dx = F(g(x))+C$.

En resumen, si somos capaces de hallar una **primitiva** para una cierta función $f$, somos capaces de hallar una **primitiva** para toda la familia de funciones $f(g(x))\cdot g'(x)$, donde $g(x)$ es una función cualquiera.

Hagamos un ejemplo ilustrativo.

## Introducción al cálculo de primitivas
<div class="example">
**Ejemplo**

En el capítulo anterior, vimos que una primitiva de la función monomio $f(x)=x^n$, con $n\geq 1$ natural era $F(x)=\frac{x^{n+1}}{n+1}+C$:
$$
\int x^n\, dx = \frac{x^{n+1}}{n+1}+C.
$$

La comprobación es muy fácil.

Usando lo que hemos dicho anteriormente, tenemos que una primitiva de la función $g(x)^n\cdot g'(x)$, donde $g$ es una función cualquiera, es $\frac{g(x)^{n+1}}{n+1}+C$:
$$
\int g(x)^n\cdot g'(x)\, dx = \frac{g(x)^{n+1}}{n+1}+C.
$$
</div>

## Introducción al cálculo de primitivas
<div class="example">
Por ejemplo, si consideramos $g(x)=\sin x$, podemos escribir: $\displaystyle \int \sin^n x\cdot \cos x\, dx =\frac{\sin^{n+1}x}{n+1}+C$.

Si consideramos $g(x)=4x^2+2$, podemos escribir: $\displaystyle \int (4x+2)^n \cdot 4\, dx =\frac{(4x+2)^{n+1}}{n+1}+C$.

Si consideramos $g(x)=\ln x$, podemos escribir: $\displaystyle \int \frac{(\ln x)^n}{x} \, dx =\frac{(\ln x)^{n+1}}{n+1}+C$.

Y así sucesivamente, eligiendo la función $g$ que queramos.
</div>

En resumen, cualquier fórmula de cálculo de **primitivas** de una cierta función $f$, equivale a tener un conjunto de fórmulas de cálculo de **primitivas** de la familia de funciones $f(g(x))\cdot g'(x)$, para cualquier función $g$.

## Introducción al cálculo de primitivas
Hemos de pensar que para la mayoría de las funciones no se puede hallar una **primitiva** usando las técnicas explicadas en este capítulo. 

Es decir, dada una función $f:[a,b]\longrightarrow\mathbb{R}$ **integrable**, una función **primitiva** sería 
$$
F(x)=\int_a^x f(t)\, dt.
$$
El problema es que, en general, no podemos hallar una expresión de $F(x)$ en términos de funciones conocidas.
Se tienen que usar técnicas de **análisis numérico** para hallar la integral definida correspondiente.

# Integrales inmediatas

## Integrales inmediatas
Vamos a dar una lista de **integrales indefinidas** que serán la base para el cálculo de las demás. 

Les llamaremos **integrales inmediatas** ya que para ver su veracidad, basta derivar la expresión correspondiente y ver que el resultado de la derivada es la función que integramos.

## Integrales inmediatas
<div class="center">
|| || 
|:---:|:---:|
|$\displaystyle\int x^n\, dx = \frac{x^{n+1}}{n+1}+C,\ n\neq -1$ | $\displaystyle\int \frac{1}{x}\, dx =\ln |x|+C$|
|$\displaystyle \int a^x dx = {a^x \over \ln a} + C, \; a> 0,\; a\not = 1$|$\displaystyle \int e^x dx = e^x + C$|
|$\displaystyle \int \sin x dx = -\cos x +C$|$\displaystyle \int \cos x dx = \sin x + C$|
|$\displaystyle \int {dx \over \cos^2 x } = \tan x + C$|$\displaystyle \int {dx \over\sin^2 x } = -\cot x + C$|
|$\displaystyle \int {dx \over 1+x^2} = \arctan x + C$|$\displaystyle \int {dx \over \sqrt{1-x^2} }= \arcsin x + C$|
</div>

# Integración de funciones racionales

## Introducción
En esta sección vamos a aprender técnicas para calcular **integrales indefinidas** de funciones racionales, es decir, funciones del tipo $\frac{P(x)}{Q(x)}$ donde $P(x)$ y $Q(x)$ son polinomios a coeficientes reales.

Distinguiremos dos casos:

* Supongamos que el grado del polinomio $P(x)$ es mayor o igual que el grado del polinomio $Q(x)$: $\mathrm{grado}(P)\geq \mathrm{grado}(Q)$.

En este caso, hemos de dividir el polinomio $P(x)$ entre el polinomio $Q(x)$ obteniendo un cociente $C(x)$ y un resto $R(x)$, donde $\mathrm{grado}(R) < \mathrm{grado}(Q)$. 

## Introducción
La relación entre los cuatro polinomios anteriores es la siguiente:
$$
P(x)=Q(x)\cdot C(x)+R(x).
$$
Si dividimos la expresión anterior por el polinomio $Q(x)$, obtenemos:
$$
\frac{P(x)}{Q(x)}=C(x)+\frac{R(x)}{Q(x)},
$$
y podemos escribir la integral indefinida de la función racional $\frac{P(x)}{Q(x)}$ como:
$$
\int \frac{P(x)}{Q(x)}\, dx=\int C(x)\, dx+\int \frac{R(x)}{Q(x)}\, dx.
$$

## Introducción
La integral indefinida $\displaystyle\int C(x)\, dx$ es sencilla de calcular ya que se trata de la integral indefinida de un polinomio que se puede escribir como la suma de integrales de monomios de la forma $\displaystyle\int x^k\, dx$ multiplicadas por constantes. Las integrales $\displaystyle \int x^k\, dx$ valen $\frac{x^{k+1}}{k+1}+C$ como está indicado en la tabla de integrales inmediatas.

La integral restante $\displaystyle \int \frac{R(x)}{Q(x)}\, dx$ se trata de una integral racional con la particularidad de que el grado del denominador es menor que el grado del numerado que sería el segundo caso a considerar.

## Introducción
En resumen, dada una integral racional, siempre podemos suponer que el grado del denominador es menor estricto que el grado del numerador ya que, en caso contrario, realizaríamos la operación indicada y estaríamos en este caso.


