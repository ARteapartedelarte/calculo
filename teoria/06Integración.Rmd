---
title: "Tema 6 - Integración de Riemann"
author: "Juan Gabriel Gomila, Arnau Mir y Llorenç Valverde"
date: ''
output: 
  ioslides_presentation:
    widescreen: true
    css: Mery_style.css
    logo: Images/calculus.gif
    fig_caption: yes
---
<script src="https://kit.fontawesome.com/a0edb659c7.js" crossorigin="anonymous"></script>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
reticulate::use_python("/Users/juangabriel/anaconda3/bin/python")
#reticulate::py_install("sympy")
```


# Introducción

## Motivación

La idea de **integración** nace de la necesidad de calcular **áreas.**

El cálculo de un **área** es la medición de la cantidad de unidades de **superficie** necesarias para una cobertura exacta de una determinada **figura plana.**

A partir de un **cuadrado unitario** el área de un rectángulo se puede calcular multiplicando la **longitud** por la **anchura** del mismo.

Dado que un **triángulo** se puede **diseccionar** y volver a montar para formar un **rectángulo**, el área del mismo se puede calcular dividiendo por dos el **área** del rectángulo correspondiente.

Usando la mismo idea, y dado que un **polígono** se puede **diseccionar** en **triángulos**, el área de cualquier polígono también se puede calcular sumando el área de los **triángulos** involucrados. 

## Motivación


Sin embargo, cuando la figura es **curva**, el cálculo de su área se complica mucho. 
Usando el mismo razonamiento que el cálculo del área de polígonos, podíamos considerar los **polígonos inscritos** y **circunscritos** como **cotas inferiores y superiores** del área de la figura a calcular.

Si hacemos dichos polígonos más "precisos" progresivamente, podemos considerar que el área de la **figura curva** sería el límite del **área** de cada colección de dichos polígonos. Ver figura siguiente.

Ésta es la idea fundamental de la **integración de Riemman** y es la que vamos a desarrollar seguidamente.

## Motivación
<div class="center">

```{r, echo=FALSE, label=int1,fig.cap="",out.width = "500px"}
knitr::include_graphics("Images/MotivacionIntegral.png",dpi=1200)
```
</div>


# Definición de integral de Riemann

## Partición de un intervalo
Para  definir las áreas de los **polígonos inscritos** y **circunscritos** como aproximaciones al área de una figura **curva** cualquiera, necesitamos definir el concepto de **partición** de un intervalo que será dónde "descansarán" los polígonos anteriores.

<l class="definition">Definición de partición de un intervalo.</l>
Sea $[a,b]\subset\mathbb{R}$ un intervalo de la recta real. Una **partición** $P$ del intervalo anterior es un conjunto finito $P=\{x_0=a< x_1<\ldots,x_n=b\}$ de puntos ordenados dentro del intervalo donde el mínimo coincide con $a$ y el máximo, con $b$. A los subintervalos $[x_i,x_{i+1}]$, para $i=0,\ldots,n-1$ se le denomina subintervalos de la partición $[a,b]$:

<div class="center">

```{r, echo=FALSE, label=part1,fig.cap="",out.width = "650px"}
knitr::include_graphics("Images/Particion.png",dpi=1200)
```
</div>


## Partición de un intervalo
Para aproximar cada vez más el área de la **figura curva** al área de la **colección de polígonos**, necesitamos introducir el concepto de **partición más fina** en el sentido de que cuánta más fina sea una partición, más buena será la aproximación del área de los **polígonos** que descansan sobre ella:

<l class="definition">Definición de partición más fina.</l>
Sea $[a,b]\subset\mathbb{R}$ un intervalo de la recta real. Sean $P$ y $P'$ dos **particiones** del intervalo $[a,b]$. Diremos que la **partición** $P'$ es más fina que la partición $P$ si $P\subseteq P'$, es decir si todos los puntos de la partición $P$ son puntos de la partición $P'$, o si se quiere decir en otros términos, si todo **subintervalo** de $P'$ está incluido en algún **subintervalo** de $P$.


## Ejemplo de partición de un intervalo
<div class="example">
**Ejemplo de partición del intervalo $[0,1]$**

Consideramos la partición siguiente del intervalo $[0,1]$:
$$
P=\left\{x_0=0<x_1=\frac{1}{3}<x_2=\frac{2}{3}<x_3=1\right\}.
$$
La siguiente partición $P'$ es más fina que $P$:
$$
P'=\left\{x_0'=0<x_1'=\frac{1}{6}<x_2'=\frac{1}{3}<x_3'=\frac{1}{2}<x_4'=\frac{2}{3}<x_5'=1\right\}.
$$

Observar que $P\subseteq P'$ ya que $\left\{0,\frac{1}{3},\frac{2}{3},1\right\}\subseteq \left\{0,\frac{1}{6},\frac{1}{3},\frac{1}{2},\frac{2}{3}, 1\right\}$.

Además, cualquier subintervalo de la partición $P'$ está incluido en algún **subintervalo** de la partición $P$:
$$
\left[0,\frac{1}{6}\right]\subseteq \left[0,\frac{1}{3}\right],\ \left[\frac{1}{6},\frac{1}{3}\right]\subseteq \left[0,\frac{1}{3}\right],\ \left[\frac{1}{3},\frac{1}{2}\right]\subseteq \left[\frac{1}{3},\frac{2}{3}\right],\ \left[\frac{1}{2},\frac{2}{3}\right]\subseteq \left[\frac{1}{3},\frac{2}{3}\right],\ \left[\frac{2}{3},1\right]\subseteq \left[\frac{2}{3},1\right]
$$
</div>

## Partición de un intervalo
El **diámetro** de una partición es una forma de medir la finura de la misma:

<l class="definition">Definición de diámetro de una partición.</l>
Sea $[a,b]\subset\mathbb{R}$ un intervalo de la recta real. Sea $P=\{x_0=a<x_1<\ldots <x_n\}$ una partición del intervalo. Llamaremos **diámetro** de la partición $P$ y lo denotaremos por $|P|$ a la longitud máxima de los subintervalos de la misma:
$$
|P|=\max_{i=1,\ldots,n} (x_i-x_{i-1}).
$$

<div class="example">
**Ejemplo anterior**

En el ejemplo anterior, tendremos que los diámetros de las particiones consideradas serán:
$$
|P|=\max\left\{\frac{1}{3}-0,\frac{2}{3}-\frac{1}{3},1-\frac{2}{3}\right\}=\frac{1}{3},\ |P'|=\max\left\{\frac{1}{6}-0,\frac{1}{3}-\frac{1}{6},\frac{1}{2}-\frac{1}{3},\frac{2}{3}-\frac{1}{2},1-\frac{2}{3}\right\}=\frac{1}{3}.
$$
Observamos que las dos particiones tienen el mismo diámetro.
</div>


## Partición de un intervalo
<l class="observ">Observación. </l> 
Dadas dos particiones, si $P'$ es más **fina** que $P$, se verifica que el diámetro de la más fina es menor o igual que el diámetro de la menos fina ya que ésta incluye todos los subintervalos de la más fina: $|P'|\leq |P|$.

A continuación vamos a definir las **aproximaciones inferior y superior** del área de la función curva a calcular usando como **colección de polígonos** los rectángulos con base en los subintervalos de las particiones y cuyas alturas serán los valores ínfimo y supremo, respectivamente, de la función en cada subintervalo:

## Sumas inferiores y superiores
<l class="definition">Definición de sumas inferiores y superiores.</l>
Sea $[a,b]\subset\mathbb{R}$ un intervalo de la recta real. Sea $P=\{x_0=a<x_1<\ldots <x_n\}$ una partición del intervalo.
Sea $f:[a,b]\longrightarrow\mathbb{R}$ una función acotada en dicho intervalo. Definimos para cada subintervalo $[x_{i-1},x_i]$ el valor ínfimo y supremo de la función en dicho subintervalo:
$$
m_i =\inf_{x\in [x_{i-1},x_i]} f(x),\quad M_i =\sup_{x\in [x_{i-1},x_i]} f(x).
$$

## Sumas inferiores y superiores
La **suma inferior** correspondiente a la partición $P$ a la función $f$ se define como:
$$
L(f,P)=\sum_{i=1}^n m_i\cdot (x_i-x_{i-1}),
$$
y la **suma superior** correspondiente a la partición $P$ a la función $f$ se define como:
$$
U(f,P)=\sum_{i=1}^n M_i\cdot (x_i-x_{i-1}).
$$

## Sumas inferiores y superiores
<l class="observ">Observación.</l>
El nombre de $L$ en la notación de **suma inferior** viene del inglés "lower" y el nombre de $U$ en la **suma superior**, de "upper".

En las dos figuras siguientes se puede ver un ejemplo de una partición de 6 puntos indicando los infimos $m_i$ y los supremos $M_i$ de la función representada en verde en cada subintervalo de la partición.

La suma de las áreas de los rectángulos en azul sería la suma inferior $L(f,P)$ correspondiente a la partición $P$ de la función $f$ y la suma de las áreas de los rectángulo en rojo, la suma superior $U(f,P)$ correspondiente a dicha partición $P$ de la función $f$.

## Sumas inferiores y superiores
<div class="center">

```{r, echo=FALSE, label=suminf1,fig.cap="",out.width = "700px"}
knitr::include_graphics("Images/SumaInferiorNet.png",dpi=1200)
```
</div>

## Sumas inferiores y superiores
<div class="center">

```{r, echo=FALSE, label=sumsup1,fig.cap="",out.width = "700px"}
knitr::include_graphics("Images/SumaSuperiorNet.png",dpi=1200)
```
</div>

## Ejemplo
<div class="example">
**Ejemplo** 

Consideremos la función $f(x)=1-x^2$ definida en el intervalo $[0,1]$ y la partición vista anteriormente:
$$
P=\left\{x_0=0<x_1=\frac{1}{3}<x_2=\frac{2}{3}<x_3=1\right\}.
$$
La suma inferior de $f$ correspondiente a la partición $P$, $L(f,P)$ sería:
$$
L(f,P)=\inf_{x\in \left[0,\frac{1}{3}\right]} f(x)\cdot \left(\frac{1}{3}-0\right)+\inf_{x\in \left[\frac{1}{3},\frac{2}{3}\right]} f(x)\cdot \left(\frac{2}{3}-\frac{1}{3}\right)+\inf_{x\in \left[\frac{2}{3},1\right]} f(x)\cdot \left(1-\frac{2}{3}\right).
$$
La función $f(x)=1-x^2$ es decreciente en el intervalo $[0,1]$ tal como muestra su gráfica. Hemos indicado con rectas verticales discontinuas los valores de la partición considerada en el eje $X$.
</div>

## Ejemplo
<div class="example">
```{r,echo=FALSE,message=FALSE,warning=FALSE}
x=seq(from=0,to=1,by=0.01)
f=function(x){1-x^2}
plot(x,f(x),type="l",xlab="x",ylab="y")
abline(h=0)
lines(c(0,0),c(0,f(0)),lty=3)
lines(c(1/3,1/3),c(0,f(1/3)),lty=3)
lines(c(2/3,2/3),c(0,f(2/3)),lty=3)
```
</div>

## Ejemplo
<div class="example">
Otra forma de ver que la función es decreciente es observar el signo de la derivada en el intervalo considerado $[0,1]$.

El valor de la derivada es $f'(x)=-2x$ y su valor será negativo para todo valor $x$ en el intervalo $[0,1]$. Por tanto, recordemos que en este caso la función es decreciente.

Usando la observación anterior, podemos afirmar que, en general, el ínfimo de la función $f$ en un subintervalo cualquiera $[x_{i-1},x_i]$ de la partición se alcanzará en el valor $x_i$: 
$$
m_i =\inf_{x\in [x_{i-1},x_i]} f(x) = f(x_i).
$$
El valor de la suma inferior será, pues,
$$
\begin{array}{rl}
L(f,P) & =f\left(\frac{1}{3}\right)\cdot \frac{1}{3}+f\left(\frac{2}{3}\right)\cdot \frac{1}{3}+f\left(1\right)\cdot \frac{1}{3}=\left(1-\frac{1}{9}\right)\cdot \frac{1}{3}+\left(1-\frac{4}{9}\right)\cdot \frac{1}{3}+\left(1-1\right)\cdot \frac{1}{3}\\
& = \frac{13}{27}=`r round((f(1/3)+f(2/3))/3,4)`.
\end{array}
$$
</div>

## Ejemplo
<div class="example">
Razonando de manera similar, podemos afirmar que, en general, el supremo de la función $f$ en un subintervalo cualquiera $[x_{i-1},x_i]$ de la partición se alcanzará en el valor $x_{i-1}$: 
$$
M_i =\sup_{x\in [x_{i-1},x_i]} f(x) = f(x_{i-1}).
$$
El valor de la suma superior será, pues,
$$
\begin{array}{rl}
U(f,P) & =f\left(0\right)\cdot \frac{1}{3}+f\left(\frac{1}{3}\right)\cdot \frac{1}{3}+f\left(\frac{2}{3}\right)\cdot \frac{1}{3}=\left(1-0\right)\cdot \frac{1}{3}+\left(1-\frac{1}{9}\right)\cdot \frac{1}{3}+\left(1-\frac{4}{9}\right)\cdot \frac{1}{3}\\
& = \frac{22}{27}=`r round((f(0)+f(1/3)+f(2/3))/3,4)`.
\end{array}
$$
En las dos figuras siguientes, hemos dibujado en verde los rectángulos correspondientes a la suma inferior $L(f,P)$ y en rojo, los correspondientes a la suma superior $U(f,P)$. Los valores obtenidos anteriormente serían, pues, la suma de las áreas de los rectángulos en verde para $L(f,P)$ y la suma de las áreas de los rectángulos en rojo para $U(f,P)$.
</div>

## Ejemplo
<div class="example">
```{r,echo=FALSE,message=FALSE,warning=FALSE}
x=seq(from=0,to=1,by=0.01)
f=function(x){1-x^2}
plot(x,f(x),type="l",xlab="x",ylab="y")
abline(h=0)
lines(c(0,0),c(0,f(0)),lty=3)
lines(c(1/3,1/3),c(0,f(1/3)),lty=3)
lines(c(2/3,2/3),c(0,f(2/3)),lty=3)
rect(0,0,1/3,f(1/3),col="green")
rect(1/3,0,2/3,f(2/3),col="green")
```
</div>

## Ejemplo
<div class="example">
```{r,echo=FALSE,message=FALSE,warning=FALSE}
x=seq(from=0,to=1,by=0.01)
f=function(x){1-x^2}
plot(x,f(x),type="l",xlab="x",ylab="y")
abline(h=0)
lines(c(0,0),c(0,f(0)),lty=3)
lines(c(1/3,1/3),c(0,f(1/3)),lty=3)
lines(c(2/3,2/3),c(0,f(2/3)),lty=3)
rect(0,0,1/3,f(0),col="red")
rect(1/3,0,2/3,f(1/3),col="red")
rect(2/3,0,1,f(2/3),col="red")
lines(x,f(x))
```

</div>


## Ejemplo
<div class="example">
El cálculo de la suma inferior y superior en `python` es el siguiente:
```{python}
def f(x):
 return(1-x**2)

x = [0.,1./3.,2./3.,1.];
suma_inferior = 0;
suma_superior = 0;
for i in range(1,len(x)):
  suma_inferior = suma_inferior+f(x[i])*(x[i]-x[i-1]);
  suma_superior = suma_superior+f(x[i-1])*(x[i]-x[i-1]);


```

</div>


## Ejemplo
<div class="example">
```{python}
print('Suma inferior={res}'.format(x=x, res=suma_inferior))
print('Suma superior={res}'.format(x=x, res=suma_superior))
```

</div>

## Sumas inferiores y superiores
<div class="exercise">
**Ejercicio**

Sea $f:[a,b]\longrightarrow \mathbb{R}$ una función acotada. Sea $P=\{x_0=a < x_1<\cdots <x_n=b\}$ una partición del intervalo $[a,b]$. 
Sea $m=\inf_{x\in [a,b]}f(x)$ el ínfimo de la función $f$ en el intervalo considerado $[a,b]$ y $M$, el supremo: $M=\sup_{x\in [a,b]}f(x)$. Demostrar que se verifican las desigualdades siguientes:
$$
m\cdot (b-a)\leq L(f,P)\leq U(f,P)\leq M\cdot (b-a).
$$
Indicación: pensad que $m_i\geq m$ y $M_i\leq M$, para todo subintervalo de la partición $P$.
</div>

El resultado siguiente nos dice cómo se comportan las **sumas inferiores y superiores** a medida que hacemos más **finas** las particiones del intervalo en cuestión:


## Sumas inferiores y superiores
<l class="prop">Proposición. </l>
Sea $f:[a,b]\longrightarrow \mathbb{R}$ una función acotada. Sean $P$ y $P'$ dos particiones del intervalo $[a,b]$. Entonces:

* Si la partición $P'$ es más fina que la partición $P$, se verifica:
$$
L(f,P')\geq L(f,P), \quad U(f,P')\leq U(f,P).
$$

* Sin necesidad de que una partición sea más fina que la otra, siempre se verifica que:
$$
L(f,P)\leq U(f,P').
$$

## Sumas inferiores y superiores

<l class="observ">Observación. </l>
La proposición anterior nos dice que a medida que las **particiones** se hacen más **finas**, las **sumas inferiores van creciendo** y las **sumas superiores van disminuyendo.** 

O, dicho en otros términos, cuánta más **fina** es la partición, el **área por defecto** de la función $f$ va **creciendo** y el **área por exceso** va **disminuyendo.**

La segunda parte nos dice que cualquier suma superior de cualquier partición siempre supera cualquier suma inferior de otra partición cualquiera. Es decir, cualquier área por exceso siempre supera cualquier área por defecto.


## Sumas inferiores y superiores
<div class="box">
<div class="important">
<i class="fa fa-dizzy"> Contenido bastante técnico. </i>
</div>
</div>

<div class="dem">
**Demostración**

Demostremos en primer lugar que $L(f,P')\geq L(f,P)$.

Sea $P=\{x_0=a<x_1<\cdots < x_n\}$ la partición $P$. Como la partición $P'$ es más fina que la partición $P$, cada subintervalo $[x_{i-1},x_i]$ de $P$ contendrá puntos de la partición de $P'$. Llamaremos $x_{i-1}=x_{i,0}<x_{i,1}<\cdots < x_{i,n_i}=x_i$ a los puntos de la partición $P'$ incluidos en el subintervalo $[x_{i-1},x_i]$. Notar que hemos llamado $x_{i,0}=x_{i-1}$ al extremo de la izquierda y $x_{i,n_i}=x_i$ al extremo de la derecha del subintervalo $[x_{i-1},x_i]$.

Sea $m_{ij}$ el ínfimo de la función $f$ en el subintervalo $[x_{i,j-1},x_{i,j}]$: $\displaystyle m_{ij} = \inf_{x\in [x_{i,j-1},x_{i,j}]} f(x),$
y $m_i$, al ínfimo de la función $f$ en el subintervalo grande $[x_{i-1},x_i]$: $\displaystyle m_i = \inf_{x\in [x_{i-1},x_{i}]} f(x).$

</div>

## Sumas inferiores y superiores
<div class="dem">
Usando la notación anterior, podemos escribir la suma inferior de $f$ respecto las particiones $P'$ y $P$ de la forma siguiente:
$$
\begin{array}{rl}
L(f,P') & = \displaystyle\sum_{i=1}^n\sum_{j=1}^{n_i} m_{ij}\cdot (x_{i,j}-x_{i,j-1}), \\
L(f,P) & = \displaystyle\sum_{i=1}^n m_{i}\cdot (x_{i}-x_{i-1}).
\end{array}
$$

De cara a realizar la resta de las dos sumas inferiores anteriores, necesitamos escribir la suma inferior $L(f,P)$ como la suma doble que aparece en la suma inferior $L(f,P')$. Para ello, notemos lo siguiente:
$$
x_i-x_{i-1}=x_{i,n_i}-x_{i,0}=x_{i,n_i}-x_{i,n_i-1}+x_{i,n_i-1}+\cdots -x_{i,1}+x_{i,1}-x_{i,0},
$$
es decir, vamos sumando y restando los valores de la partición $P'$ que están en el subintervalo $[x_{i-1},x_i]$ distintos de los extremos $x_{i-1}$ y $x_i$.
</div>

## Sumas inferiores y superiores
<div class="dem">
De esta manera obtenemos la expresión siguiente:
$$
x_i-x_{i-1}=\sum_{j=1}^{n_i} (x_{i,j}-x_{i,j-1}).
$$
La expresión anterior nos permite escribir la suma inferior de $f$ respecto la partición $P$ en términos de la suma doble que aparece en la expresión de la suma inferior de $f$ respecto la partición más fina $P'$ permitiendo obtener $L(f,P')-L(f,P)$ de forma relativamente sencilla:
$$
\begin{array}{rl}
L(f,P') & = \displaystyle\sum_{i=1}^n\sum_{j=1}^{n_i} m_{ij}\cdot (x_{i,j}-x_{i,j-1}), \\
L(f,P) & = \displaystyle\sum_{i=1}^n\sum_{j=1}^{n_i} m_{i}\cdot (x_{i,j}-x_{i,j-1}).
\end{array}
$$
Usando las expresiones anteriores, la expresión de $L(f,P')-L(f,P)$ será:
$$
L(f,P')-L(f,P) = \sum_{i=1}^n\sum_{j=1}^{n_i} (m_{ij}-m_i)\cdot (x_{i,j}-x_{i,j-1}).
$$

</div>

## Sumas inferiores y superiores
<div class="dem">
El objetivo es demostrar que $L(f,P')-L(f,P)\geq 0$, o que $L(f,P')\geq L(f,P)$. Para ello, basta observar que los sumandos que aparecen en la suma doble de la expresión anterior son positivos ya que en primer lugar, $x_{i,j}-x_{i,j-1}\geq 0$ y $m_{ij}-m_i\geq 0$, o $m_{i,j}\geq m_i$ ya que $m_{i,j}$ es el ínfimo de la función $f$ en el subintervalo $[x_{i,j-1},x_{i,j}]$ y $m_i$, el ínfimo de la función $f$ en el subintervalo $[x_{i-1},x_i]$. 

Como el subintervalo  $[x_{i,j-1},x_{i,j}]$ está incluído en el subintervalo $[x_{i-1},x_i]$, el valor de su ínfimo será mayor al ser el primer subintervalo "más pequeño que el segundo".

Queda visto por tanto que $L(f,P')\geq L(f,P)$.

</div>

## Sumas inferiores y superiores
<div class="dem">
Para demostrar que $U(f,P')\leq U(f,P)$, escribamos dichas sumas de la forma siguiente siguiendo un razonamiento similar al realizado anteriormente:
$$
\begin{array}{rl}
U(f,P') & = \displaystyle\sum_{i=1}^n\sum_{j=1}^{n_i} M_{ij}\cdot (x_{i,j}-x_{i,j-1}), \\
U(f,P) & = \displaystyle\sum_{i=1}^n\sum_{j=1}^{n_i} M_{i}\cdot (x_{i,j}-x_{i,j-1}),
\end{array}
$$
donde $M_{ij}$ es el supremo de la función $f$ en el subintervalo $[x_{i,j-1},x_{i,j}]$: $\displaystyle M_{ij} =\sup_{x\in [x_{i,j-1},x_{i,j}]} f(x),$
y $M_i$, el supremo de la función $f$ en el subintervalo grande $[x_{i-1},x_i]$: $\displaystyle M_i = \sup_{x\in [x_{i-1},x_{i}]} f(x).$

La expresión de $U(f,P')-U(f,P)$ será:
$$
U(f,P')-U(f,P)=\sum_{i=1}^n\sum_{j=1}^{n_i} (M_{ij}-M_i)\cdot (x_{i,j}-x_{i,j-1}).
$$
</div>

## Sumas inferiores y superiores
<div class="dem">
El objetivo es demostrar que $U(f,P')-U(f,P)\leq 0$, o que $L(f,P')\leq L(f,P)$. Para ello, basta observar que los sumandos que aparecen en la suma doble de la expresión anterior son negativos ya que en primer lugar, $x_{i,j}-x_{i,j-1}\geq 0$ y $M_{ij}-M_i\leq 0$, o $M_{i,j}\leq M_i$ ya que $M_{i,j}$ es el supremo de la función $f$ en el subintervalo $[x_{i,j-1},x_{i,j}]$ y $M_i$, el supremo de la función $f$ en el subintervalo $[x_{i-1},x_i]$. 

Como el subintervalo  $[x_{i,j-1},x_{i,j}]$ está incluído en el subintervalo $[x_{i-1},x_i]$, el valor de su supremo será menor al ser el primer subintervalo "más pequeño que el segundo".

Queda visto por tanto que $U(f,P')\leq U(f,P)$.

Falta demostrar que $L(f,P)\leq U(f,P')$:
$$
L(f,P)\leq L(f,P')\leq U(f,P').
$$
La primera desigualdad es consecuencia de la primera parte de esta demostración, la segunda desigualdad, consecuencia del hecho de que cualquier suma inferior siempre es menor que cualquier suma superior.
</div>


## Ejemplo
<div class="example">
**Ejemplo** 

Consideremos la función $f(x)=1-x^2$ definida en el intervalo $[0,1]$ y las particines siguientes donde $P'$, como puede observarse, es más fina que $P$:
$$
\begin{array}{rl}
P & =\left\{x_0=0<x_1=\frac{1}{3}<x_2=\frac{2}{3}<x_3=1\right\},\\
P' & =\left\{x_{0,0}=0<x_{0,1}=\frac{1}{6}<x_{1,0}=\frac{1}{3}<x_{1,1}=\frac{1}{2}<x_{1,2}=\frac{7}{12}<x_{2,0}=\frac{2}{3}<x_{2,1}=\frac{5}{6}<x_{3,0}=1\right\}.
\end{array}
$$
Comprobemos en `python` que $L(f,P')\geq L(f,P)$ y $U(f,P')\leq U(f,P)$:

</div>


## Ejemplo
<div class="example">
```{python}
def f(x):
 return(1-x**2)

P = [0.,1./3.,2./3.,1.];
P2 = [0.,1./6.,1./3.,1./2.,7./12.,2./3.,5./6.,1.]
suma_inferior_P = 0;
suma_inferior_P2 = 0;
suma_superior_P = 0;
suma_superior_P2 = 0;

for i in range(1,len(P)):
  suma_inferior_P = suma_inferior_P+f(P[i])*(P[i]-P[i-1]);
  suma_superior_P = suma_superior_P+f(P[i-1])*(P[i]-P[i-1]);

for i in range(1,len(P2)):
  suma_inferior_P2 = suma_inferior_P2+f(P2[i])*(P2[i]-P2[i-1]);
  suma_superior_P2 = suma_superior_P2+f(P2[i-1])*(P2[i]-P2[i-1]);
```

</div>


## Ejemplo
<div class="example">
```{python}
print('Suma inferior={res}'.format(x=x, res=suma_inferior_P))
print('Suma inferior partición más fina={res}'.format(x=x, res=suma_inferior_P2))

```
</div>


## Ejemplo
<div class="example">
```{python}
print('Suma superior={res}'.format(x=x, res=suma_superior_P))
print('Suma superior partición más fina={res}'.format(x=x, res=suma_superior_P2))
```

</div>


## Ejemplo
<div class="example">
Por último mostramos gráficamente las dos particiones junto con las sumas inferiores y superiores.

Los dos gráficos siguientes corresponden a las sumas inferiores de las dos particiones consideradas empezando con la menos fina y mostrando a continuación la más fina y en los dos gráficos siguientes hacemos lo mismo pero con las sumas superiores.


</div>

## Ejemplo
<div class="example">
```{r,echo=FALSE,message=FALSE,warning=FALSE}
x=seq(from=0,to=1,by=0.01)
f=function(x){1-x^2}
plot(x,f(x),type="l",xlab="x",ylab="y")
abline(h=0)
lines(c(0,0),c(0,f(0)),lty=3)
lines(c(1/3,1/3),c(0,f(1/3)),lty=3)
lines(c(2/3,2/3),c(0,f(2/3)),lty=3)
rect(0,0,1/3,f(1/3),col="green")
rect(1/3,0,2/3,f(2/3),col="green")
```
</div>

## Ejemplo
<div class="example">
```{r,echo=FALSE,message=FALSE,warning=FALSE}
x=seq(from=0,to=1,by=0.01)
plot(x,f(x),type="l",xlab="x",ylab="y")
abline(h=0)
particio = c(0,1/6,1/3,1/2,7/12,2/3,5/6,1)
for (i in 1:length(particio)){
  lines(c(particio[i],particio[i]),c(0,f(particio[i])))
}
for (i in 1:(length(particio)-1)){
  rect(particio[i],0,particio[i+1],f(particio[i+1]),col="green")
}
```
</div>

## Ejemplo
<div class="example">
```{r,echo=FALSE,message=FALSE,warning=FALSE}
x=seq(from=0,to=1,by=0.01)
f=function(x){1-x^2}
plot(x,f(x),type="l",xlab="x",ylab="y")
abline(h=0)
lines(c(0,0),c(0,f(0)),lty=3)
lines(c(1/3,1/3),c(0,f(1/3)),lty=3)
lines(c(2/3,2/3),c(0,f(2/3)),lty=3)
rect(0,0,1/3,f(0),col="red")
rect(1/3,0,2/3,f(1/3),col="red")
rect(2/3,0,1,f(2/3),col="red")
lines(x,f(x))
```

</div>

## Ejemplo
<div class="example">
```{r,echo=FALSE,message=FALSE,warning=FALSE}
x=seq(from=0,to=1,by=0.01)
plot(x,f(x),type="l",xlab="x",ylab="y")
abline(h=0)
particio = c(0,1/6,1/3,1/2,7/12,2/3,5/6,1)
for (i in 1:(length(particio)-1)){
  rect(particio[i],0,particio[i+1],f(particio[i]),col="red")
}
lines(x,f(x))
```
</div>

## Integral superior e inferior

Dada una función acotada $f$, usando la proposición anterior, a medida que hagamos **más finas** las particiones del intervalo de definición de dicha función, las **sumas inferiores** irán **aumentando**  y las **sumas superiores** irán **disminuyendo**.

Como cualquier **suma inferior** está acotada **superiormente** por una **suma superior** cualquiera, existirá el **supremo** de dichas **sumas inferiores** para todas las particiones del intervalo.

De la misma manera, como cualquier **suma superior** está acotada **inferiormente** por una **suma inferior** cualquiera, existirá el **ínfimo** de dichas **sumas superiores** para todas las particiones del intervalo.

A dicho **supremo** y a dicho **ínfimo** se le conoce como **integral inferior** y **superior** de la función $f$, respectivamente:


## Integral superior e inferior
<l class="definition">Definición de integral superior e inferior. </l>
Sea $f:[a,b]\longrightarrow\mathbb{R}$ una función acotada. Definimos **integral inferior** e **integral superior** de la función $f$ al **supremo** y al **ínfimo** de las **sumas inferiores** e **superiores** respectivamente para todas las particiones del intervalo:
$$
\underline{\int_a^b} f =\sup_P L(f,P),\quad \overline{\int_a^b} f =\inf_P U(f,P).
$$

## Integral superior e inferior
<l class="observ">Observación.</l>
Dada una partición cualquiera del intervalo $[a,b]$ se verifica siempre:
$$
L(f,P)\leq \underline{\int_a^b} f\leq \overline{\int_a^b} f \leq U(f,P).
$$
La primera desigualdad es consecuencia de que un elemento (suma inferior de $f$ respecto de una partición $P$) siempre es menor que el supremo del conjunto (supremo de las sumas inferiores de $f$ respecto de las particiones).

## Integral superior e inferior

La segunda desigualdad es consecuencia de que siempre cualquier suma inferior respecto de una partición $P$ es menor que cualquier suma superior respecto de cualquier partición $P'$ no necesariamente la misma que $P$ (ver proposición anterior): $L(f,P)\leq U(f,P')$. Si consideramos ínfimos en la parte "derecha" de la desigualdad anterior, tendremos:
$$
L(f,P)\leq\inf_{P'} U(f,P')=\overline{\int_a^b} f.
$$

## Integral superior e inferior

Y ahora, como $\overline{\int_a^b} f$ es un valor fijo, si consideramos supremos en la parte "izquierda" de la desigualdad anterior, tenemos:
$$
\underline{\int_a^b} f =\sup_P L(f,P)\leq \overline{\int_a^b} f,
$$
tal como queríamos ver.

Por último, la tercera desigualdad es consecuencia de que el ínfimo de un conjunto de elementos (sumas superiores respecto de particiones) siempre es menor que cualquiera de sus elementos (suma superior respecto de la partición $P$).

## Integral superior e inferior

La proposición siguiente nos dice que siempre es posible hallar una partición $P$, tan **fina** como sea posible, tal que la **integral superior** e **inferior** de $f$ se puede aproximar tanto como se quiera a la **suma superior** e **inferior** de $f$ respecto la partición $P$.

<l class="prop">Proposición.</l>
Sea $f:[a,b]\longrightarrow\mathbb{R}$ una función acotada. Entonces, para todo valor $\epsilon >0$, siempre es posible hallar un valor $\delta >0$ tal que si $P$ es una partición del intervalo $[a,b]$ con diámetro menor que $\delta$, $|P|<\delta$, entonces:
$$
0\leq \underline{\int_a^b} f -L(f,P)<\epsilon, \quad 0\leq U(f,P)-\overline{\int_a^b} f <\epsilon.
$$

## Integral superior e inferior

<l class="observ">Observación.</l>
La proposición anterior es equivalente a la siguiente:
Si $(P_n)_n$ es una sucesión de particiones con diámetros tendiendo a cero, $\displaystyle\lim_{n\to\infty}|P_n|=0$, entonces:
$$
\lim_{n\to\infty} L(f,P_n)=\underline{\int_a^b} f,\quad \lim_{n\to\infty} U(f,P)=\overline{\int_a^b} f.
$$


## Funciones integrables

En estos momentos ya estamos en condiciones de definir cuándo una función acotada cualquiera será **integrable**. 

La idea intuitiva es que la **integral superior** e **inferior** de la misma deben coincidir.

Es decir, los "límites" de las **sumas superiores** e **inferiores** cuando las particiones se hacen más y más finas deben ser los mismos:

## Funciones integrables

<l class="definition">Definición de función integrable.</l>
Sea $f:[a,b]\longrightarrow\mathbb{R}$ una función acotada. 
Diremos que dicha función es **integrable** si su **integral inferior** y **superior coinciden** y en este caso, llamaremos **integral de $f$ en el intervalo $[a,b]$** al valor de dichas integrales:
$$
\int_a^b f = \underline{\int_a^b}= \overline{\int_a^b} f.
$$
La integral también se indica por $\displaystyle\int_a^b f(x)\, dx$.